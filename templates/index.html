<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>VietQR Thanh Toán</title>
  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; }
    #qr { margin-top: 20px; }
    #countdown { color: red; margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Nhập số tiền để tạo mã QR VietQR</h2>
  <input type="number" id="amount" placeholder="Nhập số tiền (VNĐ)" />
  <button onclick="generateQR()">Tạo mã QR</button>

  <div id="qr"></div>
  <div id="countdown"></div>

  <script>
    // Cấu hình thông tin ngân hàng mặc định
    const bankInfo = {
      bankCode: 'VCB',         // Mã ngân hàng (ví dụ: VCB, TCB, MBB)
      accountNumber: '0123456789', // Số tài khoản nhận tiền
      accountName: 'DINH TAN HUY'  // Tên người nhận (viết hoa không dấu)
    };

    let countdownInterval;

    function generateQR() {
      const amount = document.getElementById('amount').value;
      if (!amount || amount <= 0) {
        alert("Vui lòng nhập số tiền hợp lệ.");
        return;
      }

      // Tạo URL VietQR theo chuẩn
      const qrData = `https://img.vietqr.io/image/${bankInfo.bankCode}-${bankInfo.accountNumber}-compact2.png?amount=${amount}&addInfo=THANH+TOAN&accountName=${bankInfo.accountName}`;

      // Hiển thị QR
      const qrContainer = document.getElementById('qr');
      qrContainer.innerHTML = `<img src="${qrData}" alt="VietQR" width="300">`;

      // Bắt đầu đếm ngược 5 phút
      startCountdown(5 * 60);
    }

    function startCountdown(seconds) {
      clearInterval(countdownInterval);

      const countdown = document.getElementById('countdown');

      function update() {
        const min = Math.floor(seconds / 60);
        const sec = seconds % 60;
        countdown.textContent = `Mã QR hết hạn sau: ${min}:${sec < 10 ? '0' + sec : sec}`;
        seconds--;

        if (seconds < 0) {
          clearInterval(countdownInterval);
          countdown.textContent = 'Mã QR đã hết hạn. Vui lòng tạo lại.';
          document.getElementById('qr').innerHTML = '';
        }
      }

      update();
      countdownInterval = setInterval(update, 1000);
    }
  </script>
</body>
</html>
